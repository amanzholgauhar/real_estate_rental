{% extends 'base.html' %}
{% block title %}Available Properties{% endblock %}

{% block content %}
<div class="flex flex-col lg:flex-row gap-6">
  <aside class="lg:w-1/4 bg-white p-6 rounded-lg shadow">
    <h2 class="text-xl font-semibold text-gray-700 mb-4">Filters</h2>
    <form method="get" action="{% url 'property_list' %}" class="space-y-4">
      <div>
        <label for="search" class="block text-sm font-medium text-gray-600">Search</label>
        <input type="text" name="search" id="search" value="{{ request.GET.search }}"
               class="mt-1 w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Search…"/>
      </div>
      <div>
        <label for="location" class="block text-sm font-medium text-gray-600">Location</label>
        <input type="text" name="location" id="location" value="{{ request.GET.location }}"
               class="mt-1 w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="City or region"/>
      </div>
      <div>
        <label for="price" class="block text-sm font-medium text-gray-600">Max Price</label>
        <input type="number" name="price" id="price" value="{{ request.GET.price }}"
               class="mt-1 w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="0 ₸"/>
      </div>
      <button type="submit" class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition">Apply Filters</button>
    </form>
  </aside>

  <section class="flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for property in properties %}
    <div class="bg-white rounded-lg shadow hover:shadow-lg transition flex flex-col overflow-hidden">
      <img src="{% if property.image %}{{ property.image.url }}{% else %}/static/default_image.jpg{% endif %}"
           alt="{{ property.title }}" class="w-full h-48 object-cover hover:scale-105 transition-transform duration-300"/>
      <div class="p-4 flex-1 flex flex-col">
        <h3 class="text-lg font-semibold text-gray-800">{{ property.title }}</h3>
        <p class="text-sm text-gray-600 mt-1">{{ property.location }}</p>
        <p class="text-sm text-gray-600 mt-1">
          Price: <span class="font-medium text-gray-800">{{ property.price }} ₸</span>
        </p>
        {% if property.phone_number %}
          <p class="text-sm text-gray-600 mt-1">
            Phone:
            <a href="tel:{{ property.phone_number }}" class="text-blue-600 hover:underline">
              {{ property.phone_number }}
            </a>
          </p>
        {% endif %}
        <p class="text-sm text-gray-600 mt-1">
          Owner: <span class="font-medium">{{ property.user.email }}</span>
        </p>
        <a href="{% url 'create_booking' %}?property_id={{ property.id }}"
           class="mt-4 bg-yellow-500 hover:bg-yellow-600 text-white text-center py-2 rounded-lg transition">
          Booking
        </a>
      </div>
    </div>
    {% empty %}
      <p class="col-span-full text-center text-gray-500">No properties found.</p>
    {% endfor %}
  </section>
</div>
{% endblock %}
